    Фиксация и обработка ошибок в системе учета отпуска нефтепродуктов.

     Состояние регистра ошибок равное 0 означает отсутствие ошибок
   в соответствующем регистре.

    При возникновении ошибки, код ошибки фиксируется в соответствующем регистре
   и остается там до получения команды очистки ошибок. До очистки ошибок работа
   системы блокируется.

    Реакция системы верхнего уровня на ошибку: необходимо отобразить оператору
  и зафиксировать в журнале событий дату,время,номер стояка, наименование
  регистра(ов) в котором(ых) зафиксирована(ы) ошибка(и) и тип ошибки.

   Далее дождаться от оператора команды на очистку ошибки(ок),
 после чего выдать команду очистки ошибок на соответствующий стояк.

   Если после сброса ошибок, ошибки фиксируются снова (не сбрасываются)
  оператору необходимо связаться с сервисной организацией.

 Кодировка ошибок функционирования:

    Битовая кодировка регистра ошибок I10:

    При наличии ошибки соответствующий бит устанавливается.
    I10 == 0 - ошибок нет.

       D0...D3 - ошибка, биткодированная по модулям
          D0 - Расходомер
          D1 - Модуль дискретного ввода-вывода N1 (I7044)
          D2 - Модуль аналогового ввода-вывода N2 (I7017)
          D3 - Другие модули

         D4...D15 - ошибка функционирования,

        0x0010 - нет сигнала УЗА при отпуске
        0x0020 - консоль не в рабочем положении
        0x0040 - трап не в рабочем положении
        0x0080 - не корректный ID процессора
        0x0100  - зафиксирован предельный уровень в бензовозе при отпуске.
        0x0200  - нажата аварийная кнопка
        0x0400 - логическая ошибка связи с расходомером
        0x0800 - ошибка при конфигурировании расходомера
        0x1000 - ошибка контрольной суммы EEPROM
        0x2000 - ошибка записи во FLASH
        0x4000 - таймаут связи с базой ( таймаут по приему команды)
        0x8000 - прочие ошибки.

        0x8010 - Команда аварийного останова от Host
        0x8020 - При старте налива зафиксирована утечка до открывания
                 отсечного клапана
        0x8030 - Насос не развивает давление при старте
        0x8040 - При завершении налива зафиксирована утечка после закрывания
                 отсечного клапана

---------------------------
    Кодировка регистра ошибок I11:

   0x1             Ошибка CRC EEPROM процессора
   0x2             Ошибка стирания FLASH
   0x4             Ошибка записи во FLASH
   0x10            Расходомер не обнулил массу/объем
   0x20            Нет обновл.данных для журнала
   0x40            При старте налива зафиксирована утечка до открывания
                   отсечного клапана
   0x80            Насос не развивает давление
   0x100           Ошибка привода насоса при торможении
   0x101           Авария от HOST
   0x200           Сторожевой таймер HOST
   0x201           Останов привода насоса при отпуске
   0x400           При завершении налива зафиксирована утечка после закрывания
                   отсечного клапана
   0x401           Драйверы MVD,7060 не включены
   0x800           Нажата аварийная кнопка (ES) при отпуске
   0x1000          Разорвана цепь безопасности. Код ошибки находится
                   в регистре I12.
   0x2000          Нет связи с расходомером
   0x4000          Ошибка конфигурирования расходомера при включении

При  I11=0x1000,
    I12:
         2         Нет УЗА при отпуске
         3         Уровень в автоцистерне выше допустимого
         6         Консоль не в раб.позиции
         7         Трап не в раб.позиции
         8         Некорректный ID процессора


I13...I16  Для соответствующих периферийных устройств:
 D0...D7
   1               Ошибка чтения устройства
   2               Ошибка записи в устройство
   4               Ошибка Watch Dog (только для I14)

   8               Ошибка в устройстве, код ошибки устройства в старшем байте
                   Только для I16. В этом случае  D8...D15 - код ошибки
                   согласно инструкции эксплуатации для применяемого типа
                   электропривода.
                   D8...D15 I16  повторяет значение I24,cм.ниже.

Названия драйверов устройств при индикации ошибок в соответствующем драйвере на ВРФ:

DeltaC - электропривод Дельта, электропривод насоса
I7017  - драйвер модуля ICP 7017 (аналоговый ввод)
I7041  - драйвер модуля ICP 7041 (дискретный ввод)
I7044  - драйвер модуля ICP 7044 (дискретный вывод)
MMI - дисплей ВРФ
MVD - расходомер Micromotion
OFP - Контроллер ограничения наполнения жидким топливом
TSD - трехстрочный дисплей 
---------------------------------

  Кодировка регистра ошибок электропривода  I24  в случае применения привода
    DELTA VFD-F. При применении другого типа электропривода кодировка ошибок
    берется из инструкции по эксплуатации.


  в скобках - код,отображаемый на индикаторах электропривода DELTA VFD-F

  0: Аварий зафиксировано не было;
  1: Превышение выходного тока (oc);
  2: Перенапряжение (ov);
  3: Перегрев ПЧ (oH);
  4: Перегрузка (oL);
  5: Перегрузка 1(oL1);
  6: Внешняя ошибка (EF);
  7: Защита IGBT (oсс);
  8: Сбой работы схемы ПЧ (CF3);
  9: Аппаратная защита (HPF);
  10: Выходной ток достиг 200% от Iном ПЧ при разгоне (ocA);
  11: Выходной ток достиг 200% от Iном ПЧ при замедлении (ocd);
  12: Выходной ток достиг 200% от Iном ПЧ в установившемся режиме
  (ocn);
  13: Замыкание выходной фазы на землю (GFF);
  14: Низкое напряжение (Lv);
  15: Ошибка чтения EEPROM (cF1);
  16: Ошибка записи EEPROM (cF2);
  17: Внешняя команда ПАУЗА (Base bloсk) остановила привод (bb);
  18: Двигатель перегружен (oL2);
  19: Не используется;
  20: Защита программным паролем (codE);
  21: Аварийная остановка привода (EF1);
  22: Обрыв фазы питающего напряжения (PHL);
  23: Низкий ток (Lс);
  24: Нет сигнала с датчика обратной связи (FbL);
  25: Не используется;
  26: Сбой питания вентиляторов (FAnP);
  27: Неисправность вентилятора 1 (FF1);
  28: Неисправность вентилятора 2 (FF2);
  29: Неисправность вентилятора 3 (FF3);
  30: Неисправность вентиляторов 1, 2, 3 (FF123);
  31: Неисправность вентиляторов 1, 2 (FF12);
  32: Неисправность вентиляторов 1, 3 (FF13);
  33: Неисправность вентиляторов 2, 3 (FF23);
  34: Защита от низкого напряжения на выходе привода (Fv).
  ---------------------------------

